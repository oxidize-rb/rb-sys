"use strict";(self.webpackChunkdocsite=self.webpackChunkdocsite||[]).push([[233],{933:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>c,contentTitle:()=>d,default:()=>h,frontMatter:()=>i,metadata:()=>r,toc:()=>a});const r=JSON.parse('{"id":"api-reference/rb-sys-features","title":"Crate `rb-sys`","description":"The rb-sys crate provides low-level Rust bindings for the Ruby C API, generated directly from ruby.h headers.","source":"@site/docs/api-reference/rb-sys-features.mdx","sourceDirName":"api-reference","slug":"/api-reference/rb-sys-features","permalink":"/docs/api-reference/rb-sys-features","draft":false,"unlisted":false,"editUrl":"https://github.com/oxidize-rb/rb-sys/tree/main/docsite/docs/api-reference/rb-sys-features.mdx","tags":[],"version":"current","lastUpdatedBy":"dependabot[bot]","lastUpdatedAt":1763832310000,"frontMatter":{"id":"rb-sys-features","title":"Crate `rb-sys`"},"sidebar":"docsSidebar","previous":{"title":"Deployment & Distribution","permalink":"/docs/deployment"},"next":{"title":"Gem Configuration","permalink":"/docs/api-reference/rb-sys-gem-config"}}');var n=s(4848),l=s(8453);const i={id:"rb-sys-features",title:"Crate `rb-sys`"},d="Crate rb-sys",c={},a=[{value:"Constraints",id:"constraints",level:2},{value:"Crate Features",id:"crate-features",level:2},{value:"Usage Examples",id:"usage-examples",level:2},{value:"Ruby Gem Integration",id:"ruby-gem-integration",level:3},{value:"Embedding Ruby VM",id:"embedding-ruby-vm",level:3},{value:"Ruby Version Compatibility",id:"ruby-version-compatibility",level:2}];function o(e){const t={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.header,{children:(0,n.jsxs)(t.h1,{id:"crate-rb-sys",children:["Crate ",(0,n.jsx)(t.code,{children:"rb-sys"})]})}),"\n",(0,n.jsxs)(t.p,{children:["The ",(0,n.jsx)(t.code,{children:"rb-sys"})," crate provides low-level Rust bindings for the Ruby C API, generated directly from ",(0,n.jsx)(t.code,{children:"ruby.h"})," headers."]}),"\n",(0,n.jsx)(t.h2,{id:"constraints",children:"Constraints"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:[(0,n.jsxs)(t.strong,{children:["Direct ",(0,n.jsx)(t.code,{children:"rb-sys"}),":"]})," Use for raw, ",(0,n.jsx)(t.code,{children:"unsafe"})," access to ",(0,n.jsx)(t.code,{children:"libruby"}),"."]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.strong,{children:"Gem Development:"})," For most gem development, prefer higher-level libraries (e.g., ",(0,n.jsx)(t.a,{href:"https://github.com/matsadler/magnus",children:"Magnus"})," with ",(0,n.jsx)(t.code,{children:"rb-sys"})," feature). See ",(0,n.jsx)(t.a,{href:"/docs/development-approaches",children:"Development Approaches"}),"."]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.strong,{children:"Embedding Ruby:"})," Use ",(0,n.jsx)(t.code,{children:"rb-sys"})," with the ",(0,n.jsx)(t.code,{children:"link-ruby"})," feature."]}),"\n"]}),"\n",(0,n.jsx)(t.h2,{id:"crate-features",children:"Crate Features"}),"\n",(0,n.jsxs)(t.p,{children:["The following features can be enabled in your ",(0,n.jsx)(t.code,{children:"Cargo.toml"}),"."]}),"\n",(0,n.jsxs)(t.table,{children:[(0,n.jsx)(t.thead,{children:(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.th,{style:{textAlign:"left"},children:"Feature"}),(0,n.jsx)(t.th,{style:{textAlign:"left"},children:"Description"}),(0,n.jsx)(t.th,{style:{textAlign:"left"},children:"Default"})]})}),(0,n.jsxs)(t.tbody,{children:[(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{style:{textAlign:"left"},children:(0,n.jsx)(t.code,{children:"gem"})}),(0,n.jsxs)(t.td,{style:{textAlign:"left"},children:["Configures the crate for building a Ruby gem (e.g., does not link ",(0,n.jsx)(t.code,{children:"libruby"}),")."]}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"\u2705"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{style:{textAlign:"left"},children:(0,n.jsx)(t.code,{children:"link-ruby"})}),(0,n.jsxs)(t.td,{style:{textAlign:"left"},children:["Links ",(0,n.jsx)(t.code,{children:"libruby"})," for embedding the Ruby VM in a Rust binary."]}),(0,n.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{style:{textAlign:"left"},children:(0,n.jsx)(t.code,{children:"ruby-static"})}),(0,n.jsxs)(t.td,{style:{textAlign:"left"},children:["Statically links ",(0,n.jsx)(t.code,{children:"libruby"}),". Can also be set with the ",(0,n.jsx)(t.code,{children:"RUBY_STATIC=true"})," env var."]}),(0,n.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{style:{textAlign:"left"},children:(0,n.jsx)(t.code,{children:"global-allocator"})}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Reports Rust memory allocations to the Ruby GC. Recommended for gems."}),(0,n.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{style:{textAlign:"left"},children:(0,n.jsx)(t.code,{children:"stable-api"})}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Uses Ruby's C-level stable API if available for your Ruby version."}),(0,n.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{style:{textAlign:"left"},children:(0,n.jsx)(t.code,{children:"bindgen-rbimpls"})}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Includes internal Ruby implementation types in the generated bindings."}),(0,n.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{style:{textAlign:"left"},children:(0,n.jsx)(t.code,{children:"bindgen-deprecated-types"})}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Includes deprecated Ruby functions and types in the bindings."}),(0,n.jsx)(t.td,{style:{textAlign:"left"}})]})]})]}),"\n",(0,n.jsx)(t.h2,{id:"usage-examples",children:"Usage Examples"}),"\n",(0,n.jsx)(t.h3,{id:"ruby-gem-integration",children:"Ruby Gem Integration"}),"\n",(0,n.jsxs)(t.p,{children:["Enable the ",(0,n.jsx)(t.code,{children:"gem"})," feature (default) and ",(0,n.jsx)(t.code,{children:"global-allocator"})," for memory reporting."]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-toml",children:'[dependencies]\nrb-sys = { version = "0.9", features = ["global-allocator"] }\n'})}),"\n",(0,n.jsx)(t.h3,{id:"embedding-ruby-vm",children:"Embedding Ruby VM"}),"\n",(0,n.jsxs)(t.p,{children:["Enable the ",(0,n.jsx)(t.code,{children:"link-ruby"})," feature to embed a Ruby VM."]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-toml",children:'[dependencies]\nrb-sys = { version = "0.9", features = ["link-ruby"] }\n'})}),"\n",(0,n.jsx)(t.h2,{id:"ruby-version-compatibility",children:"Ruby Version Compatibility"}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.code,{children:"rb-sys"})," is compatible with Ruby 2.6+. It detects the Ruby version at compile time and generates appropriate bindings. Ruby 3.2+ requires ",(0,n.jsx)(t.code,{children:"ruby_abi_version"})," function, which ",(0,n.jsx)(t.code,{children:"rb-sys"})," provides automatically."]})]})}function h(e={}){const{wrapper:t}={...(0,l.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(o,{...e})}):o(e)}},8453:(e,t,s)=>{s.d(t,{R:()=>i,x:()=>d});var r=s(6540);const n={},l=r.createContext(n);function i(e){const t=r.useContext(l);return r.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function d(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:i(e.components),r.createElement(l.Provider,{value:t},e.children)}}}]);