# Phase 0 Manifest: Asset Fetch Specification
# This manifest defines what assets to fetch for embedding into rb-sys-cli.
# It is keyed by Rust target triple, with a special "common" key for shared assets.
#
# Asset Types:
# - oci_extract: Extract specific files/dirs from an OCI image (pulled by digest)
# - tarball: Download and verify a tarball (unpacked in phase_1)
#
# Common optional fields:
# - strip_prefix: Remove this path prefix during extraction (oci_extract only)
# - strip_components: Number of leading path components to strip (tarball, default: 1)

[common]
# Assets shared across all platforms go here
# Example: documentation, universal scripts, etc.
assets = []

# ==============================================================================
# Linux x86_64 (GNU libc)
# ==============================================================================
[[x86_64-unknown-linux-gnu.assets]]
type = "tarball"
name = "zig"
url = "https://ziglang.org/download/0.15.2/zig-x86_64-linux-0.15.2.tar.xz"
digest = "sha256:02aa270f183da276e5b5920b1dac44a63f1a49e55050ebde3aecc9eb82f93239"
strip_components = 1

[[x86_64-unknown-linux-gnu.assets]]
type = "tarball_extract"
name = "libclang"
url = "https://github.com/llvm/llvm-project/releases/download/llvmorg-19.1.5/LLVM-19.1.5-Linux-X64.tar.xz"
extract = "**/lib/libclang.so*"
digest = "sha256:a7817e1ba812f8a270424d0e20f4b6582b0b2b8b2936650c789acd3aac0f94a5"
strip_components = 1

# ==============================================================================
# Linux aarch64 (GNU libc)
# ==============================================================================
[[aarch64-unknown-linux-gnu.assets]]
type = "tarball"
name = "zig"
url = "https://ziglang.org/download/0.15.2/zig-aarch64-linux-0.15.2.tar.xz"
digest = "sha256:958ed7d1e00d0ea76590d27666efbf7a932281b3d7ba0c6b01b0ff26498f667f"
strip_components = 1

[[aarch64-unknown-linux-gnu.assets]]
type = "tarball_extract"
name = "libclang"
url = "https://github.com/llvm/llvm-project/releases/download/llvmorg-19.1.5/clang+llvm-19.1.5-aarch64-linux-gnu.tar.xz"
extract = "**/lib/libclang.so*"
digest = "sha256:a2734c46d37651df823c5323670bf2d96b30bca2b3636209a21ebdd6c307cb6d"
strip_components = 1

# ==============================================================================
# macOS x86_64 (Intel)
# ==============================================================================
[[x86_64-apple-darwin.assets]]
type = "tarball"
name = "zig"
url = "https://ziglang.org/download/0.15.2/zig-x86_64-macos-0.15.2.tar.xz"
digest = "sha256:375b6909fc1495d16fc2c7db9538f707456bfc3373b14ee83fdd3e22b3d43f7f"
strip_components = 1

[[x86_64-apple-darwin.assets]]
type = "tarball_extract"
name = "libclang"
url = "https://github.com/llvm/llvm-project/releases/download/llvmorg-19.1.5/LLVM-19.1.5-macOS-X64.tar.xz"
extract = "**/lib/libclang.dylib"
digest = "sha256:1ca27464f2ec0547079964d257b1972849fd5680a81791927f055b171dfde4ba"
strip_components = 1

[[x86_64-apple-darwin.assets]]
type = "tarball"
name = "sdk"
url = "https://github.com/joseluisq/macosx-sdks/releases/download/26.1/MacOSX26.1.sdk.tar.xz"
digest = "sha256:beee7212d265a6d2867d0236cc069314b38d5fb3486a6515734e76fa210c784c"
strip_components = 1

# ==============================================================================
# macOS aarch64 (Apple Silicon)
# ==============================================================================
[[aarch64-apple-darwin.assets]]
type = "tarball"
name = "zig"
url = "https://ziglang.org/download/0.15.2/zig-aarch64-macos-0.15.2.tar.xz"
digest = "sha256:3cc2bab367e185cdfb27501c4b30b1b0653c28d9f73df8dc91488e66ece5fa6b"
strip_components = 1

[[aarch64-apple-darwin.assets]]
type = "tarball_extract"
name = "libclang"
url = "https://github.com/llvm/llvm-project/releases/download/llvmorg-21.1.6/LLVM-21.1.6-macOS-ARM64.tar.xz"
extract = "**/lib/libclang.dylib"
digest = "sha256:9efa477e961d95094e3f728ce91af110be4fe93cc18ee8bd0afda0355bc5a6e9"
strip_components = 1

[[aarch64-apple-darwin.assets]]
type = "tarball"
name = "sdk"
url = "https://github.com/joseluisq/macosx-sdks/releases/download/26.1/MacOSX26.1.sdk.tar.xz"
digest = "sha256:beee7212d265a6d2867d0236cc069314b38d5fb3486a6515734e76fa210c784c"
strip_components = 1

# ==============================================================================
# Windows support removed - users should install zig and llvm locally
# ==============================================================================

# ==============================================================================
# Example: OCI Extract (for future use with Ruby sysroots)
# ==============================================================================
# [[x86_64-unknown-linux-gnu.assets]]
# type = "oci_extract"
# name = "rubies"
# image = "ghcr.io/oxidize-rb/rb-sys-dock/rubies@sha256:0000000000000000000000000000000000000000000000000000000000000000"
# items = [
#   "opt/rubies/3.0.0/",
#   "opt/rubies/3.1.0/",
#   "opt/rubies/3.2.0/",
#   "opt/rubies/3.3.0/"
# ]
# strip_prefix = "opt/rubies/"
